---
description: Project structure and module organization patterns
globs:
  - "**/*.py"
  - "**/pyproject.toml"
  - "**/README.md"
alwaysApply: true
---

NOTE: This rule file was generated or updated by the `/rules-architect` command.

## Project Structure

### Monorepo Organization

This is a **monorepo** with multiple Python packages managed by Poetry:

- `modules/model/` - Papita Transactions Data Model (`papita-transactions-model`)
- `modules/registrar/` - Papita Transactions Tracker/Loader (`papita-transactions-registrar`)
- `modules/api/` - Papita Transactions API (`papita-transactions-api`)

### Module Structure

Each module follows this structure:

```
modules/{module_name}/
├── src/
│   └── papita_txns{module}/
│       ├── __init__.py
│       ├── __meta__.py          # Package metadata (version, authors, configs)
│       ├── model/                # SQLModel database models
│       ├── access/              # DTOs and repositories
│       │   ├── base/
│       │   ├── accounts/
│       │   ├── transactions/
│       │   └── ...
│       ├── services/            # Business logic layer
│       ├── handlers/            # Application interface layer
│       ├── database/            # Database connection and utilities
│       ├── configs/             # Configuration files (logging, etc.)
│       └── utils/               # Utility functions
├── tests/                       # Test files
├── alembic/                     # Database migrations (model module only)
├── pyproject.toml               # Poetry package configuration
├── README.md                    # Module documentation
└── LICENSE                      # License file
```

### Package Naming

- Package names use **snake_case**: `papita_txnsmodel`, `papita_txnsregistrar`, `papita_txnsapi`.
- Module directories match package names.
- Use underscores, not hyphens, in Python package names.

### Import Paths

- Use absolute imports from package root: `from papita_txnsmodel.access.accounts.dto import AccountDTO`.
- Add `src/` to `sys.path` in tests via `conftest.py`.
- Use `known_first_party` in isort config: `papita_txnsapi`, `papita_txnsmodel`, `papita_txnsregistrar`.

### Dependency Management

- Use **Poetry** for dependency management.
- Root `pyproject.toml` defines workspace dependencies.
- Each module has its own `pyproject.toml` with module-specific dependencies.
- Use `{path = "modules/{module}", develop = true}` for local module dependencies.

### Configuration Files

- `pyproject.toml` - Poetry, Black, isort, mypy, pylint, flake8, pytest, coverage configuration.
- `alembic.ini` - Alembic migration configuration (in model module).
- `logger.yaml` - Logging configuration (in `configs/` directories).
- `.env` - Environment variables (not committed to repo).

### Documentation

- Root `README.md` - Project overview and setup instructions.
- Module `README.md` - Module-specific documentation.
- Use docstrings for all public classes and functions.
- Include type hints in docstrings when using complex types.

### Deployment Scripts

- `deploy/` directory contains deployment and utility scripts:
  - `alembic.sh` - Database migration management
  - `package.sh` - Package building
  - `test.sh` - Testing utilities
  - `utils.sh` - Shared shell utilities

### Docker Support

- `docker/database/docker-compose.yml` - Database services for local development.
- Use Docker for consistent development environments.

### Code Quality

- Use **pre-commit hooks** for code quality checks.
- Tools: Black, isort, mypy, pylint, flake8, pytest.
- Generate coverage badges and reports.
- Use **interrogate** for documentation coverage (target: 90%+).

### Version Management

- Use semantic versioning.
- Version information in `__meta__.py` files.
- Use `genbadge` for generating badges.
