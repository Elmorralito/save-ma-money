---
description: Code style guidelines for Python formatting, linting, and type checking
globs:
  - "**/*.py"
alwaysApply: true
---

NOTE: This rule file was generated or updated by the `/rules-architect` command.

## Code Style and Formatting

### Black Configuration

- Line length: **120 characters** (not 88).
- Target Python version: **3.12**.
- Include: `\.pyi?$` (Python files and stubs).

### Import Organization (isort)

- Use `isort` with Black profile compatibility.
- Import sections (in order):
  1. `FUTURE` - `from __future__ import ...`
  2. `STDLIB` - Standard library imports
  3. `THIRDPARTY` - Third-party library imports
  4. `FIRSTPARTY` - First-party imports (`papita_txnsapi`, `papita_txnsmodel`, `papita_txnsregistrar`)
  5. `LOCALFOLDER` - Local relative imports

- Known first-party packages: `papita_txnsapi`, `papita_txnsmodel`, `papita_txnsregistrar`.
- Skip: `.gitignore`, `.dockerignore`, `.md`, `.json`, `.yaml`, `.yml`, `.sh`.
- Use `atomic = true` for safe imports.
- Use `skip_gitignore = true`.

### Type Checking (mypy)

- Python version: **3.12**.
- Disable error codes: `union-attr`, `misc`, `attr-defined`.
- Allow untyped definitions and calls (for gradual typing).
- Ignore missing imports (for optional dependencies).
- Exclude: `tests/*`.
- Use `# type: ignore` comments sparingly and with specific error codes when necessary.

### Linting (pylint)

- Max line length: **120 characters**.
- Max module lines: **1000**.
- Max arguments: **8**.
- Max complexity: **18** (from flake8).
- Ignore paths: `^.*/tests/.*$`.

#### Disabled Pylint Messages

- `broad-except` - Allow broad exception handling in repositories
- `missing-module-docstring` - Not required for all modules
- `missing-function-docstring` - Not required for all functions
- `missing-class-docstring` - Not required for all classes
- `too-few-public-methods` - Allow utility classes
- `unused-argument` - Common in decorators and callbacks
- `attribute-defined-outside-init` - Common in Pydantic models
- `duplicate-code` - Allow some code duplication for clarity

### Flake8 Configuration

- Ignore: `E203` (whitespace before ':'), `W503` (line break before binary operator).
- Max line length: **120**.
- Max complexity: **18**.
- Exclude: `.git`, `__pycache__`, `dist`, `*.ipynb`, test directories.

### General Style Rules

- Use **snake_case** for functions, variables, and file names.
- Use **PascalCase** for classes.
- Use **UPPER_CASE** for constants.
- Use descriptive names; avoid abbreviations unless widely understood.
- Prefer explicit over implicit (e.g., `if obj is None:` not `if not obj:` for None checks).
- Use f-strings for string formatting.
- Use type hints for all function signatures.
- Use `Optional[Type]` or `Type | None` for nullable types (prefer union syntax in Python 3.10+).

### Docstring Style

- Use Google-style docstrings.
- Include `Args:`, `Returns:`, `Raises:` sections.
- Document all parameters and return values.
- Include examples for complex functions.

### Code Organization

- Group imports: stdlib, third-party, first-party, local.
- Place constants at module level.
- Place classes after constants and before functions.
- Use `__all__` for explicit exports when needed.

### Comments

- Use comments to explain "why", not "what".
- Keep comments up-to-date with code changes.
- Use `# type: ignore[error-code]` for intentional type checking suppressions.
